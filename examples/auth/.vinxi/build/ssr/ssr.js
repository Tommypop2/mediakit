import{isServer as T,createComponent as p,spread as H,useAssets as X,ssr as v,escape as $,getRequestEvent as b,delegateEvents as de,ssrElement as N,mergeProps as pe,ssrHydrationKey as E,NoHydration as Z,HydrationScript as he,ssrAttribute as P,Hydration as fe,renderToString as me,renderToStream as ge}from"solid-js/web";import{createContext as we,sharedConfig as S,createUniqueId as ye,useContext as $e,createRenderEffect as ve,onCleanup as L,children as be,createMemo as j,getOwner as Ee,untrack as Se,Show as ee,on as Ce,createRoot as Te,createSignal as ke,lazy as Re,createComponent as Ae,Suspense as Ne,ErrorBoundary as Pe,catchError as xe}from"solid-js";import{c as Le,a as Oe,R as Ie,b as qe,d as Me,g as B,e as De,s as W,m as Ue,k as je,f as Fe,h as _e,n as He,i as O,j as I,l as Be,o as We,p as Ke,q as ze,r as K,t as Je,u as Ge}from"./assets/server-fns-runtime-ILk5GoHa.js";import{S as Ve}from"./assets/client-CZWpsM-c.js";import{g as te,a as re}from"./assets/auth-DgOjBUDV.js";import{r as Ye}from"./assets/response-DrwkDGKB.js";import{provideRequestEvent as Qe}from"solid-js/web/storage";import{eventHandler as Xe}from"h3";import"node:async_hooks";import"@auth/core";import"@auth/core/errors";import"@auth/core/providers/discord";import"@auth/core/providers/credentials";import"zod";const ne=we(),oe=["title","meta"],q=[],M=["name","http-equiv","content","charset","media"].concat(["property"]),x=(e,r)=>{const t=Object.fromEntries(Object.entries(e.props).filter(([n])=>r.includes(n)).sort());return(Object.hasOwn(t,"name")||Object.hasOwn(t,"property"))&&(t.name=t.name||t.property,delete t.property),e.tag+JSON.stringify(t)};function Ze(){if(!S.context){const t=document.head.querySelectorAll("[data-sm]");Array.prototype.forEach.call(t,n=>n.parentNode.removeChild(n))}const e=new Map;function r(t){if(t.ref)return t.ref;let n=document.querySelector(`[data-sm="${t.id}"]`);return n?(n.tagName.toLowerCase()!==t.tag&&(n.parentNode&&n.parentNode.removeChild(n),n=document.createElement(t.tag)),n.removeAttribute("data-sm")):n=document.createElement(t.tag),n}return{addTag(t){if(oe.indexOf(t.tag)!==-1){const s=t.tag==="title"?q:M,a=x(t,s);e.has(a)||e.set(a,[]);let i=e.get(a),l=i.length;i=[...i,t],e.set(a,i);let c=r(t);t.ref=c,H(c,t.props);let f=null;for(var n=l-1;n>=0;n--)if(i[n]!=null){f=i[n];break}return c.parentNode!=document.head&&document.head.appendChild(c),f&&f.ref&&f.ref.parentNode&&document.head.removeChild(f.ref),l}let o=r(t);return t.ref=o,H(o,t.props),o.parentNode!=document.head&&document.head.appendChild(o),-1},removeTag(t,n){const o=t.tag==="title"?q:M,s=x(t,o);if(t.ref){const a=e.get(s);if(a){if(t.ref.parentNode){t.ref.parentNode.removeChild(t.ref);for(let i=n-1;i>=0;i--)a[i]!=null&&document.head.appendChild(a[i].ref)}a[n]=null,e.set(s,a)}else t.ref.parentNode&&t.ref.parentNode.removeChild(t.ref)}}}}function et(){const e=[];return X(()=>v(ot(e))),{addTag(r){if(oe.indexOf(r.tag)!==-1){const t=r.tag==="title"?q:M,n=x(r,t),o=e.findIndex(s=>s.tag===r.tag&&x(s,t)===n);o!==-1&&e.splice(o,1)}return e.push(r),e.length},removeTag(r,t){}}}const tt=e=>{const r=T?et():Ze();return p(ne.Provider,{value:r,get children(){return e.children}})},rt=(e,r,t)=>(nt({tag:e,props:r,setting:t,id:ye(),get name(){return r.name||r.property}}),null);function nt(e){const r=$e(ne);if(!r)throw new Error("<MetaProvider /> should be in the tree");ve(()=>{const t=r.addTag(e);L(()=>r.removeTag(e,t))})}function ot(e){return e.map(r=>{const n=Object.keys(r.props).map(s=>s==="children"?"":` ${s}="${$(r.props[s],!0)}"`).join("");let o=r.props.children;return Array.isArray(o)&&(o=o.join("")),r.setting?.close?`<${r.tag} data-sm="${r.id}"${n}>${r.setting?.escape?$(o):o||""}</${r.tag}>`:`<${r.tag} data-sm="${r.id}"${n}/>`}).join("")}const st=e=>rt("title",e,{escape:!0,close:!0}),se=e=>r=>{const{base:t}=r,n=be(()=>r.children),o=j(()=>Le(n(),r.base||""));let s;const a=Oe(e,o,()=>s,{base:t,singleFlight:r.singleFlight,transformUrl:r.transformUrl});return e.create&&e.create(a),p(Ie.Provider,{value:a,get children(){return p(at,{routerState:a,get root(){return r.root},get preload(){return r.rootPreload||r.rootLoad},get children(){return[(s=Ee())&&null,p(it,{routerState:a,get branches(){return o()}})]}})}})};function at(e){const r=e.routerState.location,t=e.routerState.params,n=j(()=>e.preload&&Se(()=>{W(!0),e.preload({params:t,location:r,intent:De()||"initial"}),W(!1)}));return p(ee,{get when(){return e.root},keyed:!0,get fallback(){return e.children},children:o=>p(o,{params:t,location:r,get data(){return n()},get children(){return e.children}})})}function it(e){if(T){const o=b();if(o&&o.router&&o.router.dataOnly){ct(o,e.routerState,e.branches);return}o&&((o.router||(o.router={})).matches||(o.router.matches=e.routerState.matches().map(({route:s,path:a,params:i})=>({path:s.originalPath,pattern:s.pattern,match:a,params:i,info:s.info}))))}const r=[];let t;const n=j(Ce(e.routerState.matches,(o,s,a)=>{let i=s&&o.length===s.length;const l=[];for(let c=0,f=o.length;c<f;c++){const y=s&&s[c],g=o[c];a&&y&&g.route.key===y.route.key?l[c]=a[c]:(i=!1,r[c]&&r[c](),Te(w=>{r[c]=w,l[c]=qe(e.routerState,l[c-1]||e.routerState.base,z(()=>n()[c+1]),()=>e.routerState.matches()[c])}))}return r.splice(o.length).forEach(c=>c()),a&&i?a:(t=l[0],l)}));return z(()=>n()&&t)()}const z=e=>()=>p(ee,{get when(){return e()},keyed:!0,children:r=>p(Me.Provider,{value:r,get children(){return r.outlet()}})});function ct(e,r,t){const n=new URL(e.request.url),o=B(t,new URL(e.router.previousUrl||e.request.url).pathname),s=B(t,n.pathname);for(let a=0;a<s.length;a++){(!o[a]||s[a].route!==o[a].route)&&(e.router.dataOnly=!0);const{route:i,params:l}=s[a];i.preload&&i.preload({params:l,location:r.location,intent:"preload"})}}function lt([e,r],t,n){return[e,n?o=>r(n(o)):r]}function ut(e){let r=!1;const t=o=>typeof o=="string"?{value:o}:o,n=lt(ke(t(e.get()),{equals:(o,s)=>o.value===s.value&&o.state===s.state}),void 0,o=>(!r&&e.set(o),S.registry&&!S.done&&(S.done=!0),o));return e.init&&L(e.init((o=e.get())=>{r=!0,n[1](t(o)),r=!1})),se({signal:n,create:e.create,utils:e.utils})}function dt(e,r,t){return e.addEventListener(r,t),()=>e.removeEventListener(r,t)}function pt(e,r){const t=e&&document.getElementById(e);t?t.scrollIntoView():r&&window.scrollTo(0,0)}function ht(e){const r=new URL(e);return r.pathname+r.search}function ft(e){let r;const t={value:e.url||(r=b())&&ht(r.request.url)||""};return se({signal:[()=>t,n=>Object.assign(t,n)]})(e)}const mt=new Map;function gt(e=!0,r=!1,t="/_server",n){return o=>{const s=o.base.path(),a=o.navigatorFactory(o.base);let i={};function l(u){return u.namespaceURI==="http://www.w3.org/2000/svg"}function c(u){if(u.defaultPrevented||u.button!==0||u.metaKey||u.altKey||u.ctrlKey||u.shiftKey)return;const d=u.composedPath().find(_=>_ instanceof Node&&_.nodeName.toUpperCase()==="A");if(!d||r&&!d.hasAttribute("link"))return;const m=l(d),h=m?d.href.baseVal:d.href;if((m?d.target.baseVal:d.target)||!h&&!d.hasAttribute("state"))return;const R=(d.getAttribute("rel")||"").split(/\s+/);if(d.hasAttribute("download")||R&&R.includes("external"))return;const A=m?new URL(h,document.baseURI):new URL(h);if(!(A.origin!==window.location.origin||s&&A.pathname&&!A.pathname.toLowerCase().startsWith(s.toLowerCase())))return[d,A]}function f(u){const d=c(u);if(!d)return;const[m,h]=d,F=o.parsePath(h.pathname+h.search+h.hash),R=m.getAttribute("state");u.preventDefault(),a(F,{resolve:!1,replace:m.hasAttribute("replace"),scroll:!m.hasAttribute("noscroll"),state:R?JSON.parse(R):void 0})}function y(u){const d=c(u);if(!d)return;const[m,h]=d;typeof n=="function"&&(h.pathname=n(h.pathname)),i[h.pathname]||o.preloadRoute(h,{preloadData:m.getAttribute("preload")!=="false"})}function g(u){const d=c(u);if(!d)return;const[m,h]=d;typeof n=="function"&&(h.pathname=n(h.pathname)),!i[h.pathname]&&(i[h.pathname]=setTimeout(()=>{o.preloadRoute(h,{preloadData:m.getAttribute("preload")!=="false"}),delete i[h.pathname]},200))}function w(u){const d=c(u);if(!d)return;const[,m]=d;typeof n=="function"&&(m.pathname=n(m.pathname)),i[m.pathname]&&(clearTimeout(i[m.pathname]),delete i[m.pathname])}function k(u){if(u.defaultPrevented)return;let d=u.submitter&&u.submitter.hasAttribute("formaction")?u.submitter.getAttribute("formaction"):u.target.getAttribute("action");if(!d)return;if(!d.startsWith("https://action/")){const h=new URL(d,Ue);if(d=o.parsePath(h.pathname+h.search),!d.startsWith(t))return}if(u.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const m=mt.get(d);if(m){u.preventDefault();const h=new FormData(u.target,u.submitter);m.call({r:o,f:u.target},u.target.enctype==="multipart/form-data"?h:new URLSearchParams(h))}}de(["click","submit"]),document.addEventListener("click",f),e&&(document.addEventListener("mouseover",g),document.addEventListener("mouseout",w),document.addEventListener("focusin",y),document.addEventListener("touchstart",y)),document.addEventListener("submit",k),L(()=>{document.removeEventListener("click",f),e&&(document.removeEventListener("mouseover",g),document.removeEventListener("mouseout",w),document.removeEventListener("focusin",y),document.removeEventListener("touchstart",y)),document.removeEventListener("submit",k)})}}function wt(e){if(T)return ft(e);const r=()=>{const n=window.location.pathname.replace(/^\/+/,"/")+window.location.search,o=window.history.state&&window.history.state._depth&&Object.keys(window.history.state).length===1?void 0:window.history.state;return{value:n+window.location.hash,state:o}},t=_e();return ut({get:r,set({value:n,replace:o,scroll:s,state:a}){o?window.history.replaceState(je(a),"",n):window.history.pushState(a,"",n),pt(decodeURIComponent(window.location.hash.slice(1)),s),Fe()},init:n=>dt(window,"popstate",He(n,o=>{if(o&&o<0)return!t.confirm(o);{const s=r();return!t.confirm(s.value,{state:s.state})}})),create:gt(e.preload,e.explicitLinks,e.actionBase,e.transformUrl),utils:{go:n=>window.history.go(n),beforeLeave:t}})(e)}function yt(e){e.forEach(r=>{if(!r.attrs.href)return;let t=document.head.querySelector(`link[href="${r.attrs.href}"]`);t||(t=document.createElement("link"),t.setAttribute("rel","preload"),t.setAttribute("as","style"),t.setAttribute("href",r.attrs.href),document.head.appendChild(t))})}var $t=" ";const vt={style:e=>N("style",e.attrs,()=>$(e.children),!0),link:e=>N("link",e.attrs,void 0,!0),script:e=>e.attrs.src?N("script",pe(()=>e.attrs,{get id(){return e.key}}),()=>v($t),!0):null,noscript:e=>N("noscript",e.attrs,()=>$(e.children),!0)};function D(e,r){let{tag:t,attrs:{key:n,...o}={key:void 0},children:s}=e;return vt[t]({attrs:{...o,nonce:r},key:n,children:s})}function bt(e,r,t,n="default"){return Re(async()=>{{const s=(await e.import())[n],i=(await r.inputs?.[e.src].assets()).filter(c=>c.tag==="style"||c.attrs.rel==="stylesheet");return typeof window<"u"&&yt(i),{default:c=>[...i.map(f=>D(f)),Ae(s,c)]}}})}const C={NORMAL:0,WILDCARD:1,PLACEHOLDER:2};function Et(e={}){const r={options:e,rootNode:ae(),staticRoutesMap:{}},t=n=>e.strictTrailingSlash?n:n.replace(/\/$/,"")||"/";if(e.routes)for(const n in e.routes)J(r,t(n),e.routes[n]);return{ctx:r,lookup:n=>St(r,t(n)),insert:(n,o)=>J(r,t(n),o),remove:n=>Ct(r,t(n))}}function St(e,r){const t=e.staticRoutesMap[r];if(t)return t.data;const n=r.split("/"),o={};let s=!1,a=null,i=e.rootNode,l=null;for(let c=0;c<n.length;c++){const f=n[c];i.wildcardChildNode!==null&&(a=i.wildcardChildNode,l=n.slice(c).join("/"));const y=i.children.get(f);if(y===void 0){if(i&&i.placeholderChildren.length>1){const g=n.length-c;i=i.placeholderChildren.find(w=>w.maxDepth===g)||null}else i=i.placeholderChildren[0]||null;if(!i)break;i.paramName&&(o[i.paramName]=f),s=!0}else i=y}return(i===null||i.data===null)&&a!==null&&(i=a,o[i.paramName||"_"]=l,s=!0),i?s?{...i.data,params:s?o:void 0}:i.data:null}function J(e,r,t){let n=!0;const o=r.split("/");let s=e.rootNode,a=0;const i=[s];for(const l of o){let c;if(c=s.children.get(l))s=c;else{const f=Tt(l);c=ae({type:f,parent:s}),s.children.set(l,c),f===C.PLACEHOLDER?(c.paramName=l==="*"?`_${a++}`:l.slice(1),s.placeholderChildren.push(c),n=!1):f===C.WILDCARD&&(s.wildcardChildNode=c,c.paramName=l.slice(3)||"_",n=!1),i.push(c),s=c}}for(const[l,c]of i.entries())c.maxDepth=Math.max(i.length-l,c.maxDepth||0);return s.data=t,n===!0&&(e.staticRoutesMap[r]=s),s}function Ct(e,r){let t=!1;const n=r.split("/");let o=e.rootNode;for(const s of n)if(o=o.children.get(s),!o)return t;if(o.data){const s=n.at(-1)||"";o.data=null,Object.keys(o.children).length===0&&o.parent&&(o.parent.children.delete(s),o.parent.wildcardChildNode=null,o.parent.placeholderChildren=[]),t=!0}return t}function ae(e={}){return{type:e.type||C.NORMAL,maxDepth:0,parent:e.parent||null,children:new Map,data:e.data||null,paramName:e.paramName||null,wildcardChildNode:null,placeholderChildren:[]}}function Tt(e){return e.startsWith("**")?C.WILDCARD:e[0]===":"||e==="*"?C.PLACEHOLDER:C.NORMAL}const kt=O(I(At,"c_102kcj3","$$function0"),"something2"),Rt={load:()=>kt()};async function At(){await new Promise(r=>setTimeout(r,3e3));const e=b();return Be("session",await te(e.request,re)),1}const Nt=O(I(xt,"c_10jsfi6","$$function0"),"something"),Pt={load:()=>Nt()};async function xt(){const e=b();return await new Promise(r=>setTimeout(r,3e3)),e.request.headers.get("user-agent")}const Lt=O(I(qt,"c_ymyeph","$$function0"),"user"),Ot=O(I(Mt,"c_ymyeph","$$function1"),"something"),It={load:()=>[Lt(),Ot()]};async function qt(){const e=b(),r=await te(e.request,re);if(!r)throw Ye("/");return r}async function Mt(){const e=b();return await new Promise(r=>setTimeout(r,3e3)),e.request.headers.get("user-agent")}const ie=[{page:!0,$component:{src:"src/routes/index.tsx?pick=default&pick=$css",build:()=>import("./index.js"),import:()=>import("./index.js")},$$route:{require:()=>({route:Rt}),src:"src/routes/index.tsx?pick=route"},path:"/",filePath:"/Users/or/Desktop/mediakit2/examples/auth/src/routes/index.tsx"},{page:!0,$component:{src:"src/routes/loader.tsx?pick=default&pick=$css",build:()=>import("./loader.js"),import:()=>import("./loader.js")},$$route:{require:()=>({route:Pt}),src:"src/routes/loader.tsx?pick=route"},path:"/loader",filePath:"/Users/or/Desktop/mediakit2/examples/auth/src/routes/loader.tsx"},{page:!0,$component:{src:"src/routes/protected.tsx?pick=default&pick=$css",build:()=>import("./protected.js"),import:()=>import("./protected.js")},$$route:{require:()=>({route:It}),src:"src/routes/protected.tsx?pick=route"},path:"/protected",filePath:"/Users/or/Desktop/mediakit2/examples/auth/src/routes/protected.tsx"},{page:!0,$component:{src:"src/routes/test.tsx?pick=default&pick=$css",build:()=>import("./test.js"),import:()=>import("./test.js")},path:"/test",filePath:"/Users/or/Desktop/mediakit2/examples/auth/src/routes/test.tsx"},{page:!0,$component:{src:"src/routes/test2.tsx?pick=default&pick=$css",build:()=>import("./test2.js"),import:()=>import("./test2.js")},path:"/test2",filePath:"/Users/or/Desktop/mediakit2/examples/auth/src/routes/test2.tsx"},{page:!1,$GET:{src:"src/routes/api/auth/[...solidauth].ts?pick=GET",build:()=>import("./_...solidauth_.js"),import:()=>import("./_...solidauth_.js")},$POST:{src:"src/routes/api/auth/[...solidauth].ts?pick=POST",build:()=>import("./_...solidauth_2.js"),import:()=>import("./_...solidauth_2.js")},path:"/api/auth/*solidauth",filePath:"/Users/or/Desktop/mediakit2/examples/auth/src/routes/api/auth/[...solidauth].ts"}],Dt=Ut(ie.filter(e=>e.page));function Ut(e){function r(t,n,o,s){const a=Object.values(t).find(i=>o.startsWith(i.id+"/"));return a?(r(a.children||(a.children=[]),n,o.slice(a.id.length)),t):(t.push({...n,id:o,path:o.replace(/\/\([^)/]+\)/g,"").replace(/\([^)/]+\)/g,"")}),t)}return e.sort((t,n)=>t.path.length-n.path.length).reduce((t,n)=>r(t,n,n.path,n.path),[])}function jt(e,r){const t=_t.lookup(e);if(t&&t.route){const n=t.route[`$${r}`];return n===void 0?void 0:{handler:n,params:t.params}}}function Ft(e){return e.$GET||e.$POST||e.$PUT||e.$PATCH||e.$DELETE}const _t=Et({routes:ie.reduce((e,r)=>{if(!Ft(r))return e;let t=r.path.replace(/\/\([^)/]+\)/g,"").replace(/\([^)/]+\)/g,"").replace(/\*([^/]*)/g,(n,o)=>`**:${o}`).split("/").map(n=>n.startsWith(":")||n.startsWith("*")?n:encodeURIComponent(n)).join("/");if(/:[^/]*\?/g.test(t))throw new Error(`Optional parameters are not supported in API routes: ${t}`);if(e[t])throw new Error(`Duplicate API routes for "${t}" found at "${e[t].route.path}" and "${r.path}"`);return e[t]={route:r},e},{})});function ce(){function e(t){return{...t,...t.$$route?t.$$route.require().route:void 0,info:{...t.$$route?t.$$route.require().route.info:{},filesystem:!0},component:t.$component&&bt(t.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:t.children?t.children.map(e):void 0}}return Dt.map(e)}let G;const Ht=T?()=>b().routes:()=>G||(G=ce());function Bt(){return p(wt,{root:e=>p(tt,{get children(){return[p(st,{children:"SolidStart - Basic"}),p(Ne,{get children(){return p(Ve,{get children(){return[e.children," "]}})}})]}}),get children(){return p(Ht,{})}})}const le=T?e=>{const r=b();return r.response.status=e.code,r.response.statusText=e.text,L(()=>!r.nativeEvent.handled&&!r.complete&&(r.response.status=200)),null}:e=>null;var Wt=["<span",' style="font-size:1.5em;text-align:center;position:fixed;left:0px;bottom:55%;width:100%;">',"</span>"],Kt=["<span",' style="font-size:1.5em;text-align:center;position:fixed;left:0px;bottom:55%;width:100%;">500 | Internal Server Error</span>'];const zt=e=>{const r=T?"500 | Internal Server Error":"Error | Uncaught Client Exception";return p(Pe,{fallback:t=>(console.error(t),[v(Wt,E(),$(r)),p(le,{code:500})]),get children(){return e.children}})},Jt=e=>{let r=!1;const t=xe(()=>e.children,n=>{console.error(n),r=!!n});return r?[v(Kt,E()),p(le,{code:500})]:t};var V=["<script",">","<\/script>"],Gt=["<script",' type="module"'," async","><\/script>"],Vt=["<script",' type="module" async',"><\/script>"];const Yt=v("<!DOCTYPE html>");function ue(e,r,t=[]){for(let n=0;n<r.length;n++){const o=r[n];if(o.path!==e[0].path)continue;let s=[...t,o];if(o.children){const a=e.slice(1);if(a.length===0||(s=ue(a,o.children,s),!s))continue}return s}}function Qt(e){const r=b(),t=r.nonce;let n=[];return Promise.resolve().then(async()=>{let o=[];if(r.router&&r.router.matches){const s=[...r.router.matches];for(;s.length&&(!s[0].info||!s[0].info.filesystem);)s.shift();const a=s.length&&ue(s,r.routes);if(a){const i=globalThis.MANIFEST.client.inputs;for(let l=0;l<a.length;l++){const c=a[l],f=i[c.$component.src];o.push(f.assets())}}}n=await Promise.all(o).then(s=>[...new Map(s.flat().map(a=>[a.attrs.key,a])).values()].filter(a=>a.attrs.rel==="modulepreload"&&!r.assets.find(i=>i.attrs.key===a.attrs.key)))}),X(()=>n.length?n.map(o=>D(o)):void 0),p(Z,{get children(){return[Yt,p(Jt,{get children(){return p(e.document,{get assets(){return[p(he,{}),r.assets.map(o=>D(o,t))]},get scripts(){return t?[v(V,E()+P("nonce",$(t,!0),!1),`window.manifest = ${JSON.stringify(r.manifest)}`),v(Gt,E(),P("nonce",$(t,!0),!1),P("src",$(globalThis.MANIFEST.client.inputs[globalThis.MANIFEST.client.handler].output.path,!0),!1))]:[v(V,E(),`window.manifest = ${JSON.stringify(r.manifest)}`),v(Vt,E(),P("src",$(globalThis.MANIFEST.client.inputs[globalThis.MANIFEST.client.handler].output.path,!0),!1))]},get children(){return p(fe,{get children(){return p(zt,{get children(){return p(Bt,{})}})}})}})}})]}})}function Xt(e){const r=We(e.nativeEvent,"flash");if(!r)return;let t=JSON.parse(r);if(!t||!t.result)return;const n=[...t.input.slice(0,-1),new Map(t.input[t.input.length-1])];Ke(e.nativeEvent,"flash","",{maxAge:0});const o=t.error?new Error(t.result):t.result;return{input:n,url:t.url,pending:!1,result:t.thrown?void 0:o,error:t.thrown?o:void 0}}async function Zt(e){const r=globalThis.MANIFEST.client;return globalThis.MANIFEST.ssr,e.response.headers.set("Content-Type","text/html"),Object.assign(e,{manifest:await r.json(),assets:[...await r.inputs[r.handler].assets()],router:{submission:Xt(e)},routes:ce(),complete:!1,$islands:new Set})}const er=new Set([301,302,303,307,308]);function U(e){return e.status&&er.has(e.status)?e.status:302}function tr(e,r,t={}){return Xe({handler:n=>{const o=ze(n);return Qe(o,async()=>{const s=jt(new URL(o.request.url).pathname,o.request.method);if(s){const w=(await s.handler.import())[o.request.method];o.params=s.params||{},S.context={event:o};const k=await w(o);if(k!==void 0)return k;if(o.request.method!=="GET")throw new Error(`API handler for ${o.request.method} "${o.request.url}" did not return a response.`)}const a=await r(o),i=typeof t=="function"?await t(a):{...t},l=i.mode||"stream";if(i.nonce&&(a.nonce=i.nonce),l==="sync"){const g=me(()=>(S.context.event=a,e(a)),i);if(a.complete=!0,a.response&&a.response.headers.get("Location")){const w=U(a.response);return K(n,a.response.headers.get("Location"),w)}return g}if(i.onCompleteAll){const g=i.onCompleteAll;i.onCompleteAll=w=>{Q(a)(w),g(w)}}else i.onCompleteAll=Q(a);if(i.onCompleteShell){const g=i.onCompleteShell;i.onCompleteShell=w=>{Y(a,n)(),g(w)}}else i.onCompleteShell=Y(a,n);const c=ge(()=>(S.context.event=a,e(a)),i);if(a.response&&a.response.headers.get("Location")){const g=U(a.response);return K(n,a.response.headers.get("Location"),g)}if(l==="async")return c;const{writable:f,readable:y}=new TransformStream;return c.pipeTo(f),y})}})}function Y(e,r){return()=>{if(e.response&&e.response.headers.get("Location")){const t=U(e.response);Je(r,t),Ge(r,"Location",e.response.headers.get("Location"))}}}function Q(e){return({write:r})=>{e.complete=!0;const t=e.response&&e.response.headers.get("Location");t&&r(`<script>window.location="${t}"<\/script>`)}}function rr(e,r){return tr(e,Zt,r)}var nr=['<head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico">',"</head>"],or=["<html",' lang="en">','<body><div id="app">',"</div><!--$-->","<!--/--></body></html>"];const $r=rr(()=>p(Qt,{document:({assets:e,children:r,scripts:t})=>v(or,E(),p(Z,{get children(){return v(nr,$(e))}}),$(r),$(t))}));export{$r as default};
