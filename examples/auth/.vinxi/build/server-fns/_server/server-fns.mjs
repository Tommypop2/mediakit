import{lazy as Ue,createComponent as Le,sharedConfig as we}from"solid-js";import{ssrElement as P,escape as ie,mergeProps as _e,ssr as Be,isServer as We,getRequestEvent as qe,renderToString as He}from"solid-js/web";import{provideRequestEvent as Se}from"solid-js/web/storage";import{g as Ke,s as Xe,a as Ge,m as ae,b as ne,c as k,d as Ye}from"./cache.mjs";import{eventHandler as Je}from"h3";import"node:async_hooks";import{route as Ze}from"./c_102kcj3.mjs";import{route as Qe}from"./c_10jsfi6.mjs";import{route as et}from"./c_ymyeph.mjs";var tt=(t=>(t[t.AggregateError=1]="AggregateError",t[t.ArrowFunction=2]="ArrowFunction",t[t.ErrorPrototypeStack=4]="ErrorPrototypeStack",t[t.ObjectAssign=8]="ObjectAssign",t[t.BigIntTypedArray=16]="BigIntTypedArray",t))(tt||{});function rt(t){switch(t){case'"':return'\\"';case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"\b":return"\\b";case"	":return"\\t";case"\f":return"\\f";case"<":return"\\x3C";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return}}function p(t){let e="",r=0,s;for(let i=0,a=t.length;i<a;i++)s=rt(t[i]),s&&(e+=t.slice(r,i)+s,r=i+1);return r===0?e=t:e+=t.slice(r),e}function st(t){switch(t){case"\\\\":return"\\";case'\\"':return'"';case"\\n":return`
`;case"\\r":return"\r";case"\\b":return"\b";case"\\t":return"	";case"\\f":return"\f";case"\\x3C":return"<";case"\\u2028":return"\u2028";case"\\u2029":return"\u2029";default:return t}}function m(t){return t.replace(/(\\\\|\\"|\\n|\\r|\\b|\\t|\\f|\\u2028|\\u2029|\\x3C)/g,st)}var w="__SEROVAL_REFS__",$="$R",F=`self.${$}`;function it(t){return t==null?`${F}=${F}||[]`:`(${F}=${F}||{})["${p(t)}"]=[]`}function f(t,e){if(!t)throw e}var Re=new Map,y=new Map;function M(t){return Re.has(t)}function at(t){return y.has(t)}function nt(t){return f(M(t),new _t(t)),Re.get(t)}function ot(t){return f(at(t),new Bt(t)),y.get(t)}typeof globalThis<"u"?Object.defineProperty(globalThis,w,{value:y,configurable:!0,writable:!1,enumerable:!1}):typeof window<"u"?Object.defineProperty(window,w,{value:y,configurable:!0,writable:!1,enumerable:!1}):typeof self<"u"?Object.defineProperty(self,w,{value:y,configurable:!0,writable:!1,enumerable:!1}):typeof global<"u"&&Object.defineProperty(global,w,{value:y,configurable:!0,writable:!1,enumerable:!1});function Ie(t,e){for(let r=0,s=e.length;r<s;r++){let i=e[r];t.has(i)||(t.add(i),i.extends&&Ie(t,i.extends))}}function xe(t){if(t){let e=new Set;return Ie(e,t),[...e]}}var lt={0:"Symbol.asyncIterator",1:"Symbol.hasInstance",2:"Symbol.isConcatSpreadable",3:"Symbol.iterator",4:"Symbol.match",5:"Symbol.matchAll",6:"Symbol.replace",7:"Symbol.search",8:"Symbol.species",9:"Symbol.split",10:"Symbol.toPrimitive",11:"Symbol.toStringTag",12:"Symbol.unscopables"},Ee={[Symbol.asyncIterator]:0,[Symbol.hasInstance]:1,[Symbol.isConcatSpreadable]:2,[Symbol.iterator]:3,[Symbol.match]:4,[Symbol.matchAll]:5,[Symbol.replace]:6,[Symbol.search]:7,[Symbol.species]:8,[Symbol.split]:9,[Symbol.toPrimitive]:10,[Symbol.toStringTag]:11,[Symbol.unscopables]:12},ut={0:Symbol.asyncIterator,1:Symbol.hasInstance,2:Symbol.isConcatSpreadable,3:Symbol.iterator,4:Symbol.match,5:Symbol.matchAll,6:Symbol.replace,7:Symbol.search,8:Symbol.species,9:Symbol.split,10:Symbol.toPrimitive,11:Symbol.toStringTag,12:Symbol.unscopables},ct={2:"!0",3:"!1",1:"void 0",0:"null",4:"-0",5:"1/0",6:"-1/0",7:"0/0"},dt={2:!0,3:!1,1:void 0,0:null,4:-0,5:Number.POSITIVE_INFINITY,6:Number.NEGATIVE_INFINITY,7:Number.NaN},Ae={0:"Error",1:"EvalError",2:"RangeError",3:"ReferenceError",4:"SyntaxError",5:"TypeError",6:"URIError"},ht={0:Error,1:EvalError,2:RangeError,3:ReferenceError,4:SyntaxError,5:TypeError,6:URIError};function v(t){return{t:2,i:void 0,s:t,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}var U=v(2),L=v(3),pt=v(1),ft=v(0),vt=v(4),mt=v(5),gt=v(6),yt=v(7);function Z(t){return t instanceof EvalError?1:t instanceof RangeError?2:t instanceof ReferenceError?3:t instanceof SyntaxError?4:t instanceof TypeError?5:t instanceof URIError?6:0}function bt(t){let e=Ae[Z(t)];return t.name!==e?{name:t.name}:t.constructor.name!==e?{name:t.constructor.name}:{}}function oe(t,e){let r=bt(t),s=Object.getOwnPropertyNames(t);for(let i=0,a=s.length,n;i<a;i++)n=s[i],n!=="name"&&n!=="message"&&(n==="stack"?e&4&&(r=r||{},r[n]=t[n]):(r=r||{},r[n]=t[n]));return r}function Pe(t){return Object.isFrozen(t)?3:Object.isSealed(t)?2:Object.isExtensible(t)?0:1}function zt(t){switch(t){case Number.POSITIVE_INFINITY:return mt;case Number.NEGATIVE_INFINITY:return gt}return t!==t?yt:Object.is(t,-0)?vt:{t:0,i:void 0,s:t,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function _(t){return{t:1,i:void 0,s:p(t),l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function wt(t){return{t:3,i:void 0,s:""+t,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function St(t){return{t:4,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function Rt(t,e){return{t:5,i:t,s:e.toISOString(),l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,f:void 0,a:void 0,b:void 0,o:void 0}}function It(t,e){return{t:6,i:t,s:void 0,l:void 0,c:p(e.source),m:e.flags,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function xt(t,e){let r=new Uint8Array(e),s=r.length,i=new Array(s);for(let a=0;a<s;a++)i[a]=r[a];return{t:19,i:t,s:i,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function Et(t,e){return{t:17,i:t,s:Ee[e],l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function le(t,e){return{t:18,i:t,s:p(nt(e)),l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function ke(t,e,r){return{t:25,i:t,s:r,l:void 0,c:p(e),m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function At(t,e,r){return{t:9,i:t,s:void 0,l:e.length,c:void 0,m:void 0,p:void 0,e:void 0,a:r,f:void 0,b:void 0,o:Pe(e)}}function Pt(t,e){return{t:21,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:e,b:void 0,o:void 0}}function kt(t,e,r){return{t:15,i:t,s:void 0,l:e.length,c:e.constructor.name,m:void 0,p:void 0,e:void 0,a:void 0,f:r,b:e.byteOffset,o:void 0}}function Ft(t,e,r){return{t:16,i:t,s:void 0,l:e.length,c:e.constructor.name,m:void 0,p:void 0,e:void 0,a:void 0,f:r,b:e.byteOffset,o:void 0}}function $t(t,e,r){return{t:20,i:t,s:void 0,l:e.byteLength,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:r,b:e.byteOffset,o:void 0}}function Ot(t,e,r){return{t:13,i:t,s:Z(e),l:void 0,c:void 0,m:p(e.message),p:r,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function Ct(t,e,r){return{t:14,i:t,s:Z(e),l:void 0,c:void 0,m:p(e.message),p:r,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function Tt(t,e,r){return{t:7,i:t,s:void 0,l:e,c:void 0,m:void 0,p:void 0,e:void 0,a:r,f:void 0,b:void 0,o:void 0}}function Fe(t,e){return{t:28,i:void 0,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[t,e],f:void 0,b:void 0,o:void 0}}function $e(t,e){return{t:30,i:void 0,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[t,e],f:void 0,b:void 0,o:void 0}}function Oe(t,e,r){return{t:31,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:r,f:e,b:void 0,o:void 0}}function Vt(t,e){return{t:32,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:e,b:void 0,o:void 0}}function jt(t,e){return{t:33,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:e,b:void 0,o:void 0}}function Dt(t,e){return{t:34,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:e,b:void 0,o:void 0}}var{toString:Q}=Object.prototype;function Nt(t,e){return e instanceof Error?`Seroval caught an error during the ${t} process.
  
${e.name}
${e.message}

- For more information, please check the "cause" property of this error.
- If you believe this is an error in Seroval, please submit an issue at https://github.com/lxsmnsyc/seroval/issues/new`:`Seroval caught an error during the ${t} process.

"${Q.call(e)}"

For more information, please check the "cause" property of this error.`}var ee=class extends Error{constructor(e,r){super(Nt(e,r)),this.cause=r}},Mt=class extends ee{constructor(t){super("parsing",t)}},Ut=class extends ee{constructor(t){super("serialization",t)}},Lt=class extends ee{constructor(t){super("deserialization",t)}},O=class extends Error{constructor(e){super(`The value ${Q.call(e)} of type "${typeof e}" cannot be parsed/serialized.
      
There are few workarounds for this problem:
- Transform the value in a way that it can be serialized.
- If the reference is present on multiple runtimes (isomorphic), you can use the Reference API to map the references.`),this.value=e}},Ce=class extends Error{constructor(e){super('Unsupported node type "'+e.t+'".')}},Te=class extends Error{constructor(e){super('Missing plugin for tag "'+e+'".')}},z=class extends Error{constructor(e){super('Missing "'+e+'" instance.')}},_t=class extends Error{constructor(t){super('Missing reference for the value "'+Q.call(t)+'" of type "'+typeof t+'"'),this.value=t}},Bt=class extends Error{constructor(t){super('Missing reference for id "'+p(t)+'"')}},Wt=class extends Error{constructor(t){super('Unknown TypedArray "'+t+'"')}},qt=class{constructor(e,r){this.value=e,this.replacement=r}},Ht={},Kt={},Xt={0:{},1:{},2:{},3:{},4:{}};function B(){let t,e;return{promise:new Promise((r,s)=>{t=r,e=s}),resolve(r){t(r)},reject(r){e(r)}}}function Gt(t){return"__SEROVAL_STREAM__"in t}function A(){let t=new Set,e=[],r=!0,s=!0;function i(o){for(let l of t.keys())l.next(o)}function a(o){for(let l of t.keys())l.throw(o)}function n(o){for(let l of t.keys())l.return(o)}return{__SEROVAL_STREAM__:!0,on(o){r&&t.add(o);for(let l=0,c=e.length;l<c;l++){let d=e[l];l===c-1&&!r?s?o.return(d):o.throw(d):o.next(d)}return()=>{r&&t.delete(o)}},next(o){r&&(e.push(o),i(o))},throw(o){r&&(e.push(o),a(o),r=!1,s=!1,t.clear())},return(o){r&&(e.push(o),n(o),r=!1,s=!0,t.clear())}}}function Yt(t){let e=A(),r=t[Symbol.asyncIterator]();async function s(){try{let i=await r.next();i.done?e.return(i.value):(e.next(i.value),await s())}catch(i){e.throw(i)}}return s().catch(()=>{}),e}function Jt(t){return()=>{let e=[],r=[],s=0,i=-1,a=!1;function n(){for(let l=0,c=r.length;l<c;l++)r[l].resolve({done:!0,value:void 0})}t.on({next(l){let c=r.shift();c&&c.resolve({done:!1,value:l}),e.push(l)},throw(l){let c=r.shift();c&&c.reject(l),n(),i=e.length,e.push(l),a=!0},return(l){let c=r.shift();c&&c.resolve({done:!0,value:l}),n(),i=e.length,e.push(l)}});function o(){let l=s++,c=e[l];if(l!==i)return{done:!1,value:c};if(a)throw c;return{done:!0,value:c}}return{[Symbol.asyncIterator](){return this},async next(){if(i===-1){let l=s++;if(l>=e.length){let c=B();return r.push(c),await c.promise}return{done:!1,value:e[l]}}return s>i?{done:!0,value:void 0}:o()}}}}function Ve(t){let e=[],r=-1,s=-1,i=t[Symbol.iterator]();for(;;)try{let a=i.next();if(e.push(a.value),a.done){s=e.length-1;break}}catch(a){r=e.length,e.push(a)}return{v:e,t:r,d:s}}function Zt(t){return()=>{let e=0;return{[Symbol.iterator](){return this},next(){if(e>t.d)return{done:!0,value:void 0};let r=e++,s=t.v[r];if(r===t.t)throw s;return{done:r===t.d,value:s}}}}}var Qt=class{constructor(t){this.marked=new Set,this.plugins=t.plugins,this.features=31^(t.disabledFeatures||0),this.refs=t.refs||new Map}markRef(t){this.marked.add(t)}isMarked(t){return this.marked.has(t)}getIndexedValue(t){let e=this.refs.get(t);if(e!=null)return this.markRef(e),{type:1,value:St(e)};let r=this.refs.size;return this.refs.set(t,r),{type:0,value:r}}getReference(t){let e=this.getIndexedValue(t);return e.type===1?e:M(t)?{type:2,value:le(e.value,t)}:e}getStrictReference(t){f(M(t),new O(t));let e=this.getIndexedValue(t);return e.type===1?e.value:le(e.value,t)}parseFunction(t){return this.getStrictReference(t)}parseWellKnownSymbol(t){let e=this.getReference(t);return e.type!==0?e.value:(f(t in Ee,new O(t)),Et(e.value,t))}parseSpecialReference(t){let e=this.getIndexedValue(Xt[t]);return e.type===1?e.value:{t:26,i:e.value,s:t,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}parseIteratorFactory(){let t=this.getIndexedValue(Ht);return t.type===1?t.value:{t:27,i:t.value,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:this.parseWellKnownSymbol(Symbol.iterator),b:void 0,o:void 0}}parseAsyncIteratorFactory(){let t=this.getIndexedValue(Kt);return t.type===1?t.value:{t:29,i:t.value,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[this.parseSpecialReference(1),this.parseWellKnownSymbol(Symbol.asyncIterator)],f:void 0,b:void 0,o:void 0}}createObjectNode(t,e,r,s){return{t:r?11:10,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:s,e:void 0,a:void 0,f:void 0,b:void 0,o:Pe(e)}}createMapNode(t,e,r,s){return{t:8,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:{k:e,v:r,s},a:void 0,f:this.parseSpecialReference(0),b:void 0,o:void 0}}createPromiseConstructorNode(t){return{t:22,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:this.parseSpecialReference(1),b:void 0,o:void 0}}};function er(t){switch(t){case"Int8Array":return Int8Array;case"Int16Array":return Int16Array;case"Int32Array":return Int32Array;case"Uint8Array":return Uint8Array;case"Uint16Array":return Uint16Array;case"Uint32Array":return Uint32Array;case"Uint8ClampedArray":return Uint8ClampedArray;case"Float32Array":return Float32Array;case"Float64Array":return Float64Array;case"BigInt64Array":return BigInt64Array;case"BigUint64Array":return BigUint64Array;default:throw new Wt(t)}}function ue(t,e){switch(e){case 3:return Object.freeze(t);case 1:return Object.preventExtensions(t);case 2:return Object.seal(t);default:return t}}var tr=class{constructor(t){this.plugins=t.plugins,this.refs=t.refs||new Map}deserializeReference(t){return this.assignIndexedValue(t.i,ot(m(t.s)))}deserializeArray(t){let e=t.l,r=this.assignIndexedValue(t.i,new Array(e)),s;for(let i=0;i<e;i++)s=t.a[i],s&&(r[i]=this.deserialize(s));return ue(r,t.o),r}deserializeProperties(t,e){let r=t.s;if(r){let s=t.k,i=t.v;for(let a=0,n;a<r;a++)n=s[a],typeof n=="string"?e[m(n)]=this.deserialize(i[a]):e[this.deserialize(n)]=this.deserialize(i[a])}return e}deserializeObject(t){let e=this.assignIndexedValue(t.i,t.t===10?{}:Object.create(null));return this.deserializeProperties(t.p,e),ue(e,t.o),e}deserializeDate(t){return this.assignIndexedValue(t.i,new Date(t.s))}deserializeRegExp(t){return this.assignIndexedValue(t.i,new RegExp(m(t.c),t.m))}deserializeSet(t){let e=this.assignIndexedValue(t.i,new Set),r=t.a;for(let s=0,i=t.l;s<i;s++)e.add(this.deserialize(r[s]));return e}deserializeMap(t){let e=this.assignIndexedValue(t.i,new Map),r=t.e.k,s=t.e.v;for(let i=0,a=t.e.s;i<a;i++)e.set(this.deserialize(r[i]),this.deserialize(s[i]));return e}deserializeArrayBuffer(t){let e=new Uint8Array(t.s);return this.assignIndexedValue(t.i,e.buffer)}deserializeTypedArray(t){let e=er(t.c),r=this.deserialize(t.f);return this.assignIndexedValue(t.i,new e(r,t.b,t.l))}deserializeDataView(t){let e=this.deserialize(t.f);return this.assignIndexedValue(t.i,new DataView(e,t.b,t.l))}deserializeDictionary(t,e){if(t.p){let r=this.deserializeProperties(t.p,{});Object.assign(e,r)}return e}deserializeAggregateError(t){let e=this.assignIndexedValue(t.i,new AggregateError([],m(t.m)));return this.deserializeDictionary(t,e)}deserializeError(t){let e=ht[t.s],r=this.assignIndexedValue(t.i,new e(m(t.m)));return this.deserializeDictionary(t,r)}deserializePromise(t){let e=B(),r=this.assignIndexedValue(t.i,e),s=this.deserialize(t.f);return t.s?e.resolve(s):e.reject(s),r.promise}deserializeBoxed(t){return this.assignIndexedValue(t.i,Object(this.deserialize(t.f)))}deserializePlugin(t){let e=this.plugins;if(e){let r=m(t.c);for(let s=0,i=e.length;s<i;s++){let a=e[s];if(a.tag===r)return this.assignIndexedValue(t.i,a.deserialize(t.s,this,{id:t.i}))}}throw new Te(t.c)}deserializePromiseConstructor(t){return this.assignIndexedValue(t.i,B()).promise}deserializePromiseResolve(t){let e=this.refs.get(t.i);f(e,new z("Promise")),e.resolve(this.deserialize(t.a[1]))}deserializePromiseReject(t){let e=this.refs.get(t.i);f(e,new z("Promise")),e.reject(this.deserialize(t.a[1]))}deserializeIteratorFactoryInstance(t){this.deserialize(t.a[0]);let e=this.deserialize(t.a[1]);return Zt(e)}deserializeAsyncIteratorFactoryInstance(t){this.deserialize(t.a[0]);let e=this.deserialize(t.a[1]);return Jt(e)}deserializeStreamConstructor(t){let e=this.assignIndexedValue(t.i,A()),r=t.a.length;if(r)for(let s=0;s<r;s++)this.deserialize(t.a[s]);return e}deserializeStreamNext(t){let e=this.refs.get(t.i);f(e,new z("Stream")),e.next(this.deserialize(t.f))}deserializeStreamThrow(t){let e=this.refs.get(t.i);f(e,new z("Stream")),e.throw(this.deserialize(t.f))}deserializeStreamReturn(t){let e=this.refs.get(t.i);f(e,new z("Stream")),e.return(this.deserialize(t.f))}deserializeIteratorFactory(t){this.deserialize(t.f)}deserializeAsyncIteratorFactory(t){this.deserialize(t.a[1])}deserialize(t){try{switch(t.t){case 2:return dt[t.s];case 0:return t.s;case 1:return m(t.s);case 3:return BigInt(t.s);case 4:return this.refs.get(t.i);case 18:return this.deserializeReference(t);case 9:return this.deserializeArray(t);case 10:case 11:return this.deserializeObject(t);case 5:return this.deserializeDate(t);case 6:return this.deserializeRegExp(t);case 7:return this.deserializeSet(t);case 8:return this.deserializeMap(t);case 19:return this.deserializeArrayBuffer(t);case 16:case 15:return this.deserializeTypedArray(t);case 20:return this.deserializeDataView(t);case 14:return this.deserializeAggregateError(t);case 13:return this.deserializeError(t);case 12:return this.deserializePromise(t);case 17:return ut[t.s];case 21:return this.deserializeBoxed(t);case 25:return this.deserializePlugin(t);case 22:return this.deserializePromiseConstructor(t);case 23:return this.deserializePromiseResolve(t);case 24:return this.deserializePromiseReject(t);case 28:return this.deserializeIteratorFactoryInstance(t);case 30:return this.deserializeAsyncIteratorFactoryInstance(t);case 31:return this.deserializeStreamConstructor(t);case 32:return this.deserializeStreamNext(t);case 33:return this.deserializeStreamThrow(t);case 34:return this.deserializeStreamReturn(t);case 27:return this.deserializeIteratorFactory(t);case 29:return this.deserializeAsyncIteratorFactory(t);default:throw new Ce(t)}}catch(e){throw new Lt(e)}}},rr=/^[$A-Z_][0-9A-Z_$]*$/i;function ce(t){let e=t[0];return(e==="$"||e==="_"||e>="A"&&e<="Z"||e>="a"&&e<="z")&&rr.test(t)}function S(t){switch(t.t){case 0:return t.s+"="+t.v;case 2:return t.s+".set("+t.k+","+t.v+")";case 1:return t.s+".add("+t.v+")";case 3:return t.s+".delete("+t.k+")"}}function sr(t){let e=[],r=t[0];for(let s=1,i=t.length,a,n=r;s<i;s++)a=t[s],a.t===0&&a.v===n.v?r={t:0,s:a.s,k:void 0,v:S(r)}:a.t===2&&a.s===n.s?r={t:2,s:S(r),k:a.k,v:a.v}:a.t===1&&a.s===n.s?r={t:1,s:S(r),k:void 0,v:a.v}:a.t===3&&a.s===n.s?r={t:3,s:S(r),k:a.k,v:void 0}:(e.push(r),r=a),n=a;return e.push(r),e}function de(t){if(t.length){let e="",r=sr(t);for(let s=0,i=r.length;s<i;s++)e+=S(r[s])+",";return e}}var ir="Object.create(null)",ar="new Set",nr="new Map",or="Promise.resolve",lr="Promise.reject",ur={3:"Object.freeze",2:"Object.seal",1:"Object.preventExtensions",0:void 0},cr=class{constructor(e){this.stack=[],this.flags=[],this.assignments=[],this.plugins=e.plugins,this.features=e.features,this.marked=new Set(e.markedRefs)}createFunction(e,r){return this.features&2?(e.length===1?e[0]:"("+e.join(",")+")")+"=>"+r:"function("+e.join(",")+"){return "+r+"}"}createEffectfulFunction(e,r){return this.features&2?(e.length===1?e[0]:"("+e.join(",")+")")+"=>{"+r+"}":"function("+e.join(",")+"){"+r+"}"}markRef(e){this.marked.add(e)}isMarked(e){return this.marked.has(e)}pushObjectFlag(e,r){e!==0&&(this.markRef(r),this.flags.push({type:e,value:this.getRefParam(r)}))}resolveFlags(){let e="";for(let r=0,s=this.flags,i=s.length;r<i;r++){let a=s[r];e+=ur[a.type]+"("+a.value+"),"}return e}resolvePatches(){let e=de(this.assignments),r=this.resolveFlags();return e?r?e+r:e:r}createAssignment(e,r){this.assignments.push({t:0,s:e,k:void 0,v:r})}createAddAssignment(e,r){this.assignments.push({t:1,s:this.getRefParam(e),k:void 0,v:r})}createSetAssignment(e,r,s){this.assignments.push({t:2,s:this.getRefParam(e),k:r,v:s})}createDeleteAssignment(e,r){this.assignments.push({t:3,s:this.getRefParam(e),k:r,v:void 0})}createArrayAssign(e,r,s){this.createAssignment(this.getRefParam(e)+"["+r+"]",s)}createObjectAssign(e,r,s){this.createAssignment(this.getRefParam(e)+"."+r,s)}isIndexedValueInStack(e){return e.t===4&&this.stack.includes(e.i)}serializeReference(e){return this.assignIndexedValue(e.i,w+'.get("'+e.s+'")')}serializeArrayItem(e,r,s){return r?this.isIndexedValueInStack(r)?(this.markRef(e),this.createArrayAssign(e,s,this.getRefParam(r.i)),""):this.serialize(r):""}serializeArray(e){let r=e.i;if(e.l){this.stack.push(r);let s=e.a,i=this.serializeArrayItem(r,s[0],0),a=i==="";for(let n=1,o=e.l,l;n<o;n++)l=this.serializeArrayItem(r,s[n],n),i+=","+l,a=l==="";return this.stack.pop(),this.pushObjectFlag(e.o,e.i),this.assignIndexedValue(r,"["+i+(a?",]":"]"))}return this.assignIndexedValue(r,"[]")}serializeProperty(e,r,s){if(typeof r=="string"){let i=Number(r),a=i>=0&&i.toString()===r||ce(r);if(this.isIndexedValueInStack(s)){let n=this.getRefParam(s.i);return this.markRef(e.i),a&&i!==i?this.createObjectAssign(e.i,r,n):this.createArrayAssign(e.i,a?r:'"'+r+'"',n),""}return(a?r:'"'+r+'"')+":"+this.serialize(s)}return"["+this.serialize(r)+"]:"+this.serialize(s)}serializeProperties(e,r){let s=r.s;if(s){let i=r.k,a=r.v;this.stack.push(e.i);let n=this.serializeProperty(e,i[0],a[0]);for(let o=1,l=n;o<s;o++)l=this.serializeProperty(e,i[o],a[o]),n+=(l&&n&&",")+l;return this.stack.pop(),"{"+n+"}"}return"{}"}serializeObject(e){return this.pushObjectFlag(e.o,e.i),this.assignIndexedValue(e.i,this.serializeProperties(e,e.p))}serializeWithObjectAssign(e,r,s){let i=this.serializeProperties(e,r);return i!=="{}"?"Object.assign("+s+","+i+")":s}serializeStringKeyAssignment(e,r,s,i){let a=this.serialize(i),n=Number(s),o=n>=0&&n.toString()===s||ce(s);if(this.isIndexedValueInStack(i))o&&n!==n?this.createObjectAssign(e.i,s,a):this.createArrayAssign(e.i,o?s:'"'+s+'"',a);else{let l=this.assignments;this.assignments=r,o&&n!==n?this.createObjectAssign(e.i,s,a):this.createArrayAssign(e.i,o?s:'"'+s+'"',a),this.assignments=l}}serializeAssignment(e,r,s,i){if(typeof s=="string")this.serializeStringKeyAssignment(e,r,s,i);else{let a=this.stack;this.stack=[];let n=this.serialize(i);this.stack=a;let o=this.assignments;this.assignments=r,this.createArrayAssign(e.i,this.serialize(s),n),this.assignments=o}}serializeAssignments(e,r){let s=r.s;if(s){let i=[],a=r.k,n=r.v;this.stack.push(e.i);for(let o=0;o<s;o++)this.serializeAssignment(e,i,a[o],n[o]);return this.stack.pop(),de(i)}}serializeDictionary(e,r){if(e.p)if(this.features&8)r=this.serializeWithObjectAssign(e,e.p,r);else{this.markRef(e.i);let s=this.serializeAssignments(e,e.p);if(s)return"("+this.assignIndexedValue(e.i,r)+","+s+this.getRefParam(e.i)+")"}return this.assignIndexedValue(e.i,r)}serializeNullConstructor(e){return this.pushObjectFlag(e.o,e.i),this.serializeDictionary(e,ir)}serializeDate(e){return this.assignIndexedValue(e.i,'new Date("'+e.s+'")')}serializeRegExp(e){return this.assignIndexedValue(e.i,"/"+e.c+"/"+e.m)}serializeSetItem(e,r){return this.isIndexedValueInStack(r)?(this.markRef(e),this.createAddAssignment(e,this.getRefParam(r.i)),""):this.serialize(r)}serializeSet(e){let r=ar,s=e.l,i=e.i;if(s){let a=e.a;this.stack.push(i);let n=this.serializeSetItem(i,a[0]);for(let o=1,l=n;o<s;o++)l=this.serializeSetItem(i,a[o]),n+=(l&&n&&",")+l;this.stack.pop(),n&&(r+="(["+n+"])")}return this.assignIndexedValue(i,r)}serializeMapEntry(e,r,s,i){if(this.isIndexedValueInStack(r)){let a=this.getRefParam(r.i);if(this.markRef(e),this.isIndexedValueInStack(s)){let o=this.getRefParam(s.i);return this.createSetAssignment(e,a,o),""}if(s.t!==4&&s.i!=null&&this.isMarked(s.i)){let o="("+this.serialize(s)+",["+i+","+i+"])";return this.createSetAssignment(e,a,this.getRefParam(s.i)),this.createDeleteAssignment(e,i),o}let n=this.stack;return this.stack=[],this.createSetAssignment(e,a,this.serialize(s)),this.stack=n,""}if(this.isIndexedValueInStack(s)){let a=this.getRefParam(s.i);if(this.markRef(e),r.t!==4&&r.i!=null&&this.isMarked(r.i)){let o="("+this.serialize(r)+",["+i+","+i+"])";return this.createSetAssignment(e,this.getRefParam(r.i),a),this.createDeleteAssignment(e,i),o}let n=this.stack;return this.stack=[],this.createSetAssignment(e,this.serialize(r),a),this.stack=n,""}return"["+this.serialize(r)+","+this.serialize(s)+"]"}serializeMap(e){let r=nr,s=e.e.s,i=e.i,a=e.f,n=this.getRefParam(a.i);if(s){let o=e.e.k,l=e.e.v;this.stack.push(i);let c=this.serializeMapEntry(i,o[0],l[0],n);for(let d=1,u=c;d<s;d++)u=this.serializeMapEntry(i,o[d],l[d],n),c+=(u&&c&&",")+u;this.stack.pop(),c&&(r+="(["+c+"])")}return a.t===26&&(this.markRef(a.i),r="("+this.serialize(a)+","+r+")"),this.assignIndexedValue(i,r)}serializeArrayBuffer(e){let r="new Uint8Array(",s=e.s,i=s.length;if(i){r+="["+s[0];for(let a=1;a<i;a++)r+=","+s[a];r+="]"}return this.assignIndexedValue(e.i,r+").buffer")}serializeTypedArray(e){return this.assignIndexedValue(e.i,"new "+e.c+"("+this.serialize(e.f)+","+e.b+","+e.l+")")}serializeDataView(e){return this.assignIndexedValue(e.i,"new DataView("+this.serialize(e.f)+","+e.b+","+e.l+")")}serializeAggregateError(e){let r=e.i;this.stack.push(r);let s=this.serializeDictionary(e,'new AggregateError([],"'+e.m+'")');return this.stack.pop(),s}serializeError(e){return this.serializeDictionary(e,"new "+Ae[e.s]+'("'+e.m+'")')}serializePromise(e){let r,s=e.f,i=e.i,a=e.s?or:lr;if(this.isIndexedValueInStack(s)){let n=this.getRefParam(s.i);r=a+(e.s?"().then("+this.createFunction([],n)+")":"().catch("+this.createEffectfulFunction([],"throw "+n)+")")}else{this.stack.push(i);let n=this.serialize(s);this.stack.pop(),r=a+"("+n+")"}return this.assignIndexedValue(i,r)}serializeWellKnownSymbol(e){return this.assignIndexedValue(e.i,lt[e.s])}serializeBoxed(e){return this.assignIndexedValue(e.i,"Object("+this.serialize(e.f)+")")}serializePlugin(e){let r=this.plugins;if(r)for(let s=0,i=r.length;s<i;s++){let a=r[s];if(a.tag===e.c)return this.assignIndexedValue(e.i,a.serialize(e.s,this,{id:e.i}))}throw new Te(e.c)}getConstructor(e){let r=this.serialize(e);return r===this.getRefParam(e.i)?r:"("+r+")"}serializePromiseConstructor(e){return this.assignIndexedValue(e.i,this.getConstructor(e.f)+"()")}serializePromiseResolve(e){return this.getConstructor(e.a[0])+"("+this.getRefParam(e.i)+","+this.serialize(e.a[1])+")"}serializePromiseReject(e){return this.getConstructor(e.a[0])+"("+this.getRefParam(e.i)+","+this.serialize(e.a[1])+")"}serializeSpecialReferenceValue(e){switch(e){case 0:return"[]";case 1:return this.createFunction(["s","f","p"],"((p=new Promise("+this.createEffectfulFunction(["a","b"],"s=a,f=b")+")).s=s,p.f=f,p)");case 2:return this.createEffectfulFunction(["p","d"],'p.s(d),p.status="success",p.value=d;delete p.s;delete p.f');case 3:return this.createEffectfulFunction(["p","d"],'p.f(d),p.status="failure",p.value=d;delete p.s;delete p.f');case 4:return this.createFunction(["b","a","s","l","p","f","e","n"],"(b=[],a=!0,s=!1,l=[],p=0,f="+this.createEffectfulFunction(["v","m","x"],"for(x=0;x<p;x++)l[x]&&l[x][m](v)")+",n="+this.createEffectfulFunction(["o","x","z","c"],'for(x=0,z=b.length;x<z;x++)(c=b[x],(!a&&x===z-1)?o[s?"return":"throw"](c):o.next(c))')+",e="+this.createFunction(["o","t"],"(a&&(l[t=p++]=o),n(o),"+this.createEffectfulFunction([],"a&&(l[t]=void 0)")+")")+",{__SEROVAL_STREAM__:!0,on:"+this.createFunction(["o"],"e(o)")+",next:"+this.createEffectfulFunction(["v"],'a&&(b.push(v),f(v,"next"))')+",throw:"+this.createEffectfulFunction(["v"],'a&&(b.push(v),f(v,"throw"),a=s=!1,l.length=0)')+",return:"+this.createEffectfulFunction(["v"],'a&&(b.push(v),f(v,"return"),a=!1,s=!0,l.length=0)')+"})");default:return""}}serializeSpecialReference(e){return this.assignIndexedValue(e.i,this.serializeSpecialReferenceValue(e.s))}serializeIteratorFactory(e){let r="",s=!1;return e.f.t!==4&&(this.markRef(e.f.i),r="("+this.serialize(e.f)+",",s=!0),r+=this.assignIndexedValue(e.i,this.createFunction(["s"],this.createFunction(["i","c","d","t"],"(i=0,t={["+this.getRefParam(e.f.i)+"]:"+this.createFunction([],"t")+",next:"+this.createEffectfulFunction([],"if(i>s.d)return{done:!0,value:void 0};if(d=s.v[c=i++],c===s.t)throw d;return{done:c===s.d,value:d}")+"})"))),s&&(r+=")"),r}serializeIteratorFactoryInstance(e){return this.getConstructor(e.a[0])+"("+this.serialize(e.a[1])+")"}serializeAsyncIteratorFactory(e){let r=e.a[0],s=e.a[1],i="";r.t!==4&&(this.markRef(r.i),i+="("+this.serialize(r)),s.t!==4&&(this.markRef(s.i),i+=(i?",":"(")+this.serialize(s)),i&&(i+=",");let a=this.assignIndexedValue(e.i,this.createFunction(["s"],this.createFunction(["b","c","p","d","e","t","f"],"(b=[],c=0,p=[],d=-1,e=!1,f="+this.createEffectfulFunction(["i","l"],"for(i=0,l=p.length;i<l;i++)p[i].s({done:!0,value:void 0})")+",s.on({next:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.s({done:!1,value:v});b.push(v)")+",throw:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.f(v);f(),d=b.length,e=!0,b.push(v)")+",return:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.s({done:!0,value:v});f(),d=b.length,b.push(v)")+"}),t={["+this.getRefParam(s.i)+"]:"+this.createFunction([],"t")+",next:"+this.createEffectfulFunction(["i","t","v"],"if(d===-1){return((i=c++)>=b.length)?(p.push(t="+this.getRefParam(r.i)+"()),t):{done:!1,value:b[i]}}if(c>d)return{done:!0,value:void 0};if(v=b[i=c++],i!==d)return{done:!1,value:v};if(e)throw v;return{done:!0,value:v}")+"})")));return i?i+a+")":a}serializeAsyncIteratorFactoryInstance(e){return this.getConstructor(e.a[0])+"("+this.serialize(e.a[1])+")"}serializeStreamConstructor(e){let r=this.assignIndexedValue(e.i,this.getConstructor(e.f)+"()"),s=e.a.length;if(s){let i=this.serialize(e.a[0]);for(let a=1;a<s;a++)i+=","+this.serialize(e.a[a]);return"("+r+","+i+","+this.getRefParam(e.i)+")"}return r}serializeStreamNext(e){return this.getRefParam(e.i)+".next("+this.serialize(e.f)+")"}serializeStreamThrow(e){return this.getRefParam(e.i)+".throw("+this.serialize(e.f)+")"}serializeStreamReturn(e){return this.getRefParam(e.i)+".return("+this.serialize(e.f)+")"}serialize(e){try{switch(e.t){case 2:return ct[e.s];case 0:return""+e.s;case 1:return'"'+e.s+'"';case 3:return e.s+"n";case 4:return this.getRefParam(e.i);case 18:return this.serializeReference(e);case 9:return this.serializeArray(e);case 10:return this.serializeObject(e);case 11:return this.serializeNullConstructor(e);case 5:return this.serializeDate(e);case 6:return this.serializeRegExp(e);case 7:return this.serializeSet(e);case 8:return this.serializeMap(e);case 19:return this.serializeArrayBuffer(e);case 16:case 15:return this.serializeTypedArray(e);case 20:return this.serializeDataView(e);case 14:return this.serializeAggregateError(e);case 13:return this.serializeError(e);case 12:return this.serializePromise(e);case 17:return this.serializeWellKnownSymbol(e);case 21:return this.serializeBoxed(e);case 22:return this.serializePromiseConstructor(e);case 23:return this.serializePromiseResolve(e);case 24:return this.serializePromiseReject(e);case 25:return this.serializePlugin(e);case 26:return this.serializeSpecialReference(e);case 27:return this.serializeIteratorFactory(e);case 28:return this.serializeIteratorFactoryInstance(e);case 29:return this.serializeAsyncIteratorFactory(e);case 30:return this.serializeAsyncIteratorFactoryInstance(e);case 31:return this.serializeStreamConstructor(e);case 32:return this.serializeStreamNext(e);case 33:return this.serializeStreamThrow(e);case 34:return this.serializeStreamReturn(e);default:throw new Ce(e)}}catch(r){throw new Ut(r)}}},dr=class extends cr{constructor(t){super(t),this.mode="cross",this.scopeId=t.scopeId}getRefParam(t){return $+"["+t+"]"}assignIndexedValue(t,e){return this.getRefParam(t)+"="+e}serializeTop(t){let e=this.serialize(t),r=t.i;if(r==null)return e;let s=this.resolvePatches(),i=this.getRefParam(r),a=this.scopeId==null?"":$,n=s?e+","+s+i:e;if(a==="")return s?"("+n+")":n;let o=this.scopeId==null?"()":"("+$+'["'+p(this.scopeId)+'"])';return"("+this.createFunction([a],n)+")"+o}},hr=class extends Qt{parseItems(e){let r=[];for(let s=0,i=e.length;s<i;s++)s in e&&(r[s]=this.parse(e[s]));return r}parseArray(e,r){return At(e,r,this.parseItems(r))}parseProperties(e){let r=Object.entries(e),s=[],i=[];for(let n=0,o=r.length;n<o;n++)s.push(p(r[n][0])),i.push(this.parse(r[n][1]));let a=Symbol.iterator;return a in e&&(s.push(this.parseWellKnownSymbol(a)),i.push(Fe(this.parseIteratorFactory(),this.parse(Ve(e))))),a=Symbol.asyncIterator,a in e&&(s.push(this.parseWellKnownSymbol(a)),i.push($e(this.parseAsyncIteratorFactory(),this.parse(A())))),a=Symbol.toStringTag,a in e&&(s.push(this.parseWellKnownSymbol(a)),i.push(_(e[a]))),a=Symbol.isConcatSpreadable,a in e&&(s.push(this.parseWellKnownSymbol(a)),i.push(e[a]?U:L)),{k:s,v:i,s:s.length}}parsePlainObject(e,r,s){return this.createObjectNode(e,r,s,this.parseProperties(r))}parseBoxed(e,r){return Pt(e,this.parse(r.valueOf()))}parseTypedArray(e,r){return kt(e,r,this.parse(r.buffer))}parseBigIntTypedArray(e,r){return Ft(e,r,this.parse(r.buffer))}parseDataView(e,r){return $t(e,r,this.parse(r.buffer))}parseError(e,r){let s=oe(r,this.features);return Ot(e,r,s?this.parseProperties(s):void 0)}parseAggregateError(e,r){let s=oe(r,this.features);return Ct(e,r,s?this.parseProperties(s):void 0)}parseMap(e,r){let s=[],i=[];for(let[a,n]of r.entries())s.push(this.parse(a)),i.push(this.parse(n));return this.createMapNode(e,s,i,r.size)}parseSet(e,r){let s=[];for(let i of r.keys())s.push(this.parse(i));return Tt(e,r.size,s)}parsePlugin(e,r){let s=this.plugins;if(s)for(let i=0,a=s.length;i<a;i++){let n=s[i];if(n.parse.sync&&n.test(r))return ke(e,n.tag,n.parse.sync(r,this,{id:e}))}}parseStream(e,r){return Oe(e,this.parseSpecialReference(4),[])}parsePromise(e,r){return this.createPromiseConstructorNode(e)}parseObject(e,r){if(Array.isArray(r))return this.parseArray(e,r);if(Gt(r))return this.parseStream(e,r);let s=r.constructor;if(s===qt)return this.parse(r.replacement);let i=this.parsePlugin(e,r);if(i)return i;switch(s){case Object:return this.parsePlainObject(e,r,!1);case void 0:return this.parsePlainObject(e,r,!0);case Date:return Rt(e,r);case RegExp:return It(e,r);case Error:case EvalError:case RangeError:case ReferenceError:case SyntaxError:case TypeError:case URIError:return this.parseError(e,r);case Number:case Boolean:case String:case BigInt:return this.parseBoxed(e,r);case ArrayBuffer:return xt(e,r);case Int8Array:case Int16Array:case Int32Array:case Uint8Array:case Uint16Array:case Uint32Array:case Uint8ClampedArray:case Float32Array:case Float64Array:return this.parseTypedArray(e,r);case DataView:return this.parseDataView(e,r);case Map:return this.parseMap(e,r);case Set:return this.parseSet(e,r)}if(s===Promise||r instanceof Promise)return this.parsePromise(e,r);let a=this.features;if(a&16)switch(s){case BigInt64Array:case BigUint64Array:return this.parseBigIntTypedArray(e,r)}if(a&1&&typeof AggregateError<"u"&&(s===AggregateError||r instanceof AggregateError))return this.parseAggregateError(e,r);if(r instanceof Error)return this.parseError(e,r);if(Symbol.iterator in r||Symbol.asyncIterator in r)return this.parsePlainObject(e,r,!!s);throw new O(r)}parse(e){try{switch(typeof e){case"boolean":return e?U:L;case"undefined":return pt;case"string":return _(e);case"number":return zt(e);case"bigint":return wt(e);case"object":{if(e){let r=this.getReference(e);return r.type===0?this.parseObject(r.value,e):r.value}return ft}case"symbol":return this.parseWellKnownSymbol(e);case"function":return this.parseFunction(e);default:throw new O(e)}}catch(r){throw new Mt(r)}}},pr=class extends hr{constructor(e){super(e),this.alive=!0,this.pending=0,this.initial=!0,this.buffer=[],this.onParseCallback=e.onParse,this.onErrorCallback=e.onError,this.onDoneCallback=e.onDone}onParseInternal(e,r){try{this.onParseCallback(e,r)}catch(s){this.onError(s)}}flush(){for(let e=0,r=this.buffer.length;e<r;e++)this.onParseInternal(this.buffer[e],!1)}onParse(e){this.initial?this.buffer.push(e):this.onParseInternal(e,!1)}onError(e){if(this.onErrorCallback)this.onErrorCallback(e);else throw e}onDone(){this.onDoneCallback&&this.onDoneCallback()}pushPendingState(){this.pending++}popPendingState(){--this.pending<=0&&this.onDone()}parseProperties(e){let r=Object.entries(e),s=[],i=[];for(let n=0,o=r.length;n<o;n++)s.push(p(r[n][0])),i.push(this.parse(r[n][1]));let a=Symbol.iterator;return a in e&&(s.push(this.parseWellKnownSymbol(a)),i.push(Fe(this.parseIteratorFactory(),this.parse(Ve(e))))),a=Symbol.asyncIterator,a in e&&(s.push(this.parseWellKnownSymbol(a)),i.push($e(this.parseAsyncIteratorFactory(),this.parse(Yt(e))))),a=Symbol.toStringTag,a in e&&(s.push(this.parseWellKnownSymbol(a)),i.push(_(e[a]))),a=Symbol.isConcatSpreadable,a in e&&(s.push(this.parseWellKnownSymbol(a)),i.push(e[a]?U:L)),{k:s,v:i,s:s.length}}parsePromise(e,r){return r.then(s=>{let i=this.parseWithError(s);i&&this.onParse({t:23,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[this.parseSpecialReference(2),i],f:void 0,b:void 0,o:void 0}),this.popPendingState()},s=>{if(this.alive){let i=this.parseWithError(s);i&&this.onParse({t:24,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[this.parseSpecialReference(3),i],f:void 0,b:void 0,o:void 0})}this.popPendingState()}),this.pushPendingState(),this.createPromiseConstructorNode(e)}parsePlugin(e,r){let s=this.plugins;if(s)for(let i=0,a=s.length;i<a;i++){let n=s[i];if(n.parse.stream&&n.test(r))return ke(e,n.tag,n.parse.stream(r,this,{id:e}))}}parseStream(e,r){let s=Oe(e,this.parseSpecialReference(4),[]);return this.pushPendingState(),r.on({next:i=>{if(this.alive){let a=this.parseWithError(i);a&&this.onParse(Vt(e,a))}},throw:i=>{if(this.alive){let a=this.parseWithError(i);a&&this.onParse(jt(e,a))}this.popPendingState()},return:i=>{if(this.alive){let a=this.parseWithError(i);a&&this.onParse(Dt(e,a))}this.popPendingState()}}),s}parseWithError(e){try{return this.parse(e)}catch(r){this.onError(r);return}}start(e){let r=this.parseWithError(e);r&&(this.onParseInternal(r,!0),this.initial=!1,this.flush(),this.pending<=0&&this.destroy())}destroy(){this.alive&&(this.onDone(),this.alive=!1)}isAlive(){return this.alive}},fr=class extends pr{constructor(){super(...arguments),this.mode="cross"}};function vr(t,e){let r=xe(e.plugins),s=new fr({plugins:r,refs:e.refs,disabledFeatures:e.disabledFeatures,onParse(i,a){let n=new dr({plugins:r,features:s.features,scopeId:e.scopeId,markedRefs:s.marked}),o;try{o=n.serializeTop(i)}catch(l){e.onError&&e.onError(l);return}e.onSerialize(o,a)},onError:e.onError,onDone:e.onDone});return s.start(t),()=>{s.destroy()}}var mr=class extends tr{constructor(e){super(e),this.mode="vanilla",this.marked=new Set(e.markedRefs)}assignIndexedValue(e,r){return this.marked.has(e)&&this.refs.set(e,r),r}};function he(t,e={}){let r=xe(e.plugins);return new mr({plugins:r,markedRefs:t.m}).deserialize(t.t)}function C(t){return{detail:t.detail,bubbles:t.bubbles,cancelable:t.cancelable,composed:t.composed}}var gr={tag:"seroval-plugins/web/CustomEvent",test(t){return typeof CustomEvent>"u"?!1:t instanceof CustomEvent},parse:{sync(t,e){return{type:e.parse(t.type),options:e.parse(C(t))}},async async(t,e){return{type:await e.parse(t.type),options:await e.parse(C(t))}},stream(t,e){return{type:e.parse(t.type),options:e.parse(C(t))}}},serialize(t,e){return"new CustomEvent("+e.serialize(t.type)+","+e.serialize(t.options)+")"},deserialize(t,e){return new CustomEvent(e.deserialize(t.type),e.deserialize(t.options))}},W=gr,yr={tag:"seroval-plugins/web/DOMException",test(t){return typeof DOMException>"u"?!1:t instanceof DOMException},parse:{sync(t,e){return{name:e.parse(t.name),message:e.parse(t.message)}},async async(t,e){return{name:await e.parse(t.name),message:await e.parse(t.message)}},stream(t,e){return{name:e.parse(t.name),message:e.parse(t.message)}}},serialize(t,e){return"new DOMException("+e.serialize(t.message)+","+e.serialize(t.name)+")"},deserialize(t,e){return new DOMException(e.deserialize(t.message),e.deserialize(t.name))}},q=yr;function T(t){return{bubbles:t.bubbles,cancelable:t.cancelable,composed:t.composed}}var br={tag:"seroval-plugins/web/Event",test(t){return typeof Event>"u"?!1:t instanceof Event},parse:{sync(t,e){return{type:e.parse(t.type),options:e.parse(T(t))}},async async(t,e){return{type:await e.parse(t.type),options:await e.parse(T(t))}},stream(t,e){return{type:e.parse(t.type),options:e.parse(T(t))}}},serialize(t,e){return"new Event("+e.serialize(t.type)+","+e.serialize(t.options)+")"},deserialize(t,e){return new Event(e.deserialize(t.type),e.deserialize(t.options))}},H=br,zr={tag:"seroval-plugins/web/File",test(t){return typeof File>"u"?!1:t instanceof File},parse:{async async(t,e){return{name:await e.parse(t.name),options:await e.parse({type:t.type,lastModified:t.lastModified}),buffer:await e.parse(await t.arrayBuffer())}}},serialize(t,e){return"new File(["+e.serialize(t.buffer)+"],"+e.serialize(t.name)+","+e.serialize(t.options)+")"},deserialize(t,e){return new File([e.deserialize(t.buffer)],e.deserialize(t.name),e.deserialize(t.options))}},wr=zr;function V(t){let e=[];return t.forEach((r,s)=>{e.push([s,r])}),e}var R={},Sr={tag:"seroval-plugins/web/FormDataFactory",test(t){return t===R},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(t,e){return e.createEffectfulFunction(["e","f","i","s","t"],"f=new FormData;for(i=0,s=e.length;i<s;i++)f.append((t=e[i])[0],t[1]);return f")},deserialize(){return R}},Rr={tag:"seroval-plugins/web/FormData",extends:[wr,Sr],test(t){return typeof FormData>"u"?!1:t instanceof FormData},parse:{sync(t,e){return{factory:e.parse(R),entries:e.parse(V(t))}},async async(t,e){return{factory:await e.parse(R),entries:await e.parse(V(t))}},stream(t,e){return{factory:e.parse(R),entries:e.parse(V(t))}}},serialize(t,e){return"("+e.serialize(t.factory)+")("+e.serialize(t.entries)+")"},deserialize(t,e){let r=new FormData,s=e.deserialize(t.entries);for(let i=0,a=s.length;i<a;i++){let n=s[i];r.append(n[0],n[1])}return r}},K=Rr;function j(t){let e=[];return t.forEach((r,s)=>{e.push([s,r])}),e}var Ir={tag:"seroval-plugins/web/Headers",test(t){return typeof Headers>"u"?!1:t instanceof Headers},parse:{sync(t,e){return e.parse(j(t))},async async(t,e){return await e.parse(j(t))},stream(t,e){return e.parse(j(t))}},serialize(t,e){return"new Headers("+e.serialize(t)+")"},deserialize(t,e){return new Headers(e.deserialize(t))}},x=Ir,I={},xr={tag:"seroval-plugins/web/ReadableStreamFactory",test(t){return t===I},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(t,e){return e.createFunction(["d"],"new ReadableStream({start:"+e.createEffectfulFunction(["c"],"d.on({next:"+e.createEffectfulFunction(["v"],"c.enqueue(v)")+",throw:"+e.createEffectfulFunction(["v"],"c.error(v)")+",return:"+e.createEffectfulFunction([],"c.close()")+"})")+"})")},deserialize(){return I}};function pe(t){let e=A(),r=t.getReader();async function s(){try{let i=await r.read();i.done?e.return(i.value):(e.next(i.value),await s())}catch(i){e.throw(i)}}return s().catch(()=>{}),e}var Er={tag:"seroval/plugins/web/ReadableStream",extends:[xr],test(t){return typeof ReadableStream>"u"?!1:t instanceof ReadableStream},parse:{sync(t,e){return{factory:e.parse(I),stream:e.parse(A())}},async async(t,e){return{factory:await e.parse(I),stream:await e.parse(pe(t))}},stream(t,e){return{factory:e.parse(I),stream:e.parse(pe(t))}}},serialize(t,e){return"("+e.serialize(t.factory)+")("+e.serialize(t.stream)+")"},deserialize(t,e){let r=e.deserialize(t.stream);return new ReadableStream({start(s){r.on({next(i){s.enqueue(i)},throw(i){s.error(i)},return(){s.close()}})}})}},E=Er;function fe(t,e){return{body:e,cache:t.cache,credentials:t.credentials,headers:t.headers,integrity:t.integrity,keepalive:t.keepalive,method:t.method,mode:t.mode,redirect:t.redirect,referrer:t.referrer,referrerPolicy:t.referrerPolicy}}var Ar={tag:"seroval-plugins/web/Request",extends:[E,x],test(t){return typeof Request>"u"?!1:t instanceof Request},parse:{async async(t,e){return{url:await e.parse(t.url),options:await e.parse(fe(t,t.body?await t.clone().arrayBuffer():null))}},stream(t,e){return{url:e.parse(t.url),options:e.parse(fe(t,t.clone().body))}}},serialize(t,e){return"new Request("+e.serialize(t.url)+","+e.serialize(t.options)+")"},deserialize(t,e){return new Request(e.deserialize(t.url),e.deserialize(t.options))}},X=Ar;function ve(t){return{headers:t.headers,status:t.status,statusText:t.statusText}}var Pr={tag:"seroval-plugins/web/Response",extends:[E,x],test(t){return typeof Response>"u"?!1:t instanceof Response},parse:{async async(t,e){return{body:await e.parse(t.body?await t.clone().arrayBuffer():null),options:await e.parse(ve(t))}},stream(t,e){return{body:e.parse(t.clone().body),options:e.parse(ve(t))}}},serialize(t,e){return"new Response("+e.serialize(t.body)+","+e.serialize(t.options)+")"},deserialize(t,e){return new Response(e.deserialize(t.body),e.deserialize(t.options))}},G=Pr,kr={tag:"seroval-plugins/web/URLSearchParams",test(t){return typeof URLSearchParams>"u"?!1:t instanceof URLSearchParams},parse:{sync(t,e){return e.parse(t.toString())},async async(t,e){return await e.parse(t.toString())},stream(t,e){return e.parse(t.toString())}},serialize(t,e){return"new URLSearchParams("+e.serialize(t)+")"},deserialize(t,e){return new URLSearchParams(e.deserialize(t))}},Y=kr,Fr={tag:"seroval-plugins/web/URL",test(t){return typeof URL>"u"?!1:t instanceof URL},parse:{sync(t,e){return e.parse(t.href)},async async(t,e){return await e.parse(t.href)},stream(t,e){return e.parse(t.href)}},serialize(t,e){return"new URL("+e.serialize(t)+")"},deserialize(t,e){return new URL(e.deserialize(t))}},J=Fr;const D="Invariant Violation",{setPrototypeOf:$r=function(t,e){return t.__proto__=e,t}}=Object;class te extends Error{framesToPop=1;name=D;constructor(e=D){super(typeof e=="number"?`${D}: ${e} (see https://github.com/apollographql/invariant-packages)`:e),$r(this,te.prototype)}}function Or(t,e){if(!t)throw new te(e)}const b={NORMAL:0,WILDCARD:1,PLACEHOLDER:2};function Cr(t={}){const e={options:t,rootNode:je(),staticRoutesMap:{}},r=s=>t.strictTrailingSlash?s:s.replace(/\/$/,"")||"/";if(t.routes)for(const s in t.routes)me(e,r(s),t.routes[s]);return{ctx:e,lookup:s=>Tr(e,r(s)),insert:(s,i)=>me(e,r(s),i),remove:s=>Vr(e,r(s))}}function Tr(t,e){const r=t.staticRoutesMap[e];if(r)return r.data;const s=e.split("/"),i={};let a=!1,n=null,o=t.rootNode,l=null;for(let c=0;c<s.length;c++){const d=s[c];o.wildcardChildNode!==null&&(n=o.wildcardChildNode,l=s.slice(c).join("/"));const u=o.children.get(d);if(u===void 0){if(o&&o.placeholderChildren.length>1){const h=s.length-c;o=o.placeholderChildren.find(g=>g.maxDepth===h)||null}else o=o.placeholderChildren[0]||null;if(!o)break;o.paramName&&(i[o.paramName]=d),a=!0}else o=u}return(o===null||o.data===null)&&n!==null&&(o=n,i[o.paramName||"_"]=l,a=!0),o?a?{...o.data,params:a?i:void 0}:o.data:null}function me(t,e,r){let s=!0;const i=e.split("/");let a=t.rootNode,n=0;const o=[a];for(const l of i){let c;if(c=a.children.get(l))a=c;else{const d=jr(l);c=je({type:d,parent:a}),a.children.set(l,c),d===b.PLACEHOLDER?(c.paramName=l==="*"?`_${n++}`:l.slice(1),a.placeholderChildren.push(c),s=!1):d===b.WILDCARD&&(a.wildcardChildNode=c,c.paramName=l.slice(3)||"_",s=!1),o.push(c),a=c}}for(const[l,c]of o.entries())c.maxDepth=Math.max(o.length-l,c.maxDepth||0);return a.data=r,s===!0&&(t.staticRoutesMap[e]=a),a}function Vr(t,e){let r=!1;const s=e.split("/");let i=t.rootNode;for(const a of s)if(i=i.children.get(a),!i)return r;if(i.data){const a=s.at(-1)||"";i.data=null,Object.keys(i.children).length===0&&i.parent&&(i.parent.children.delete(a),i.parent.wildcardChildNode=null,i.parent.placeholderChildren=[]),r=!0}return r}function je(t={}){return{type:t.type||b.NORMAL,maxDepth:0,parent:t.parent||null,children:new Map,data:t.data||null,paramName:t.paramName||null,wildcardChildNode:null,placeholderChildren:[]}}function jr(t){return t.startsWith("**")?b.WILDCARD:t[0]===":"||t==="*"?b.PLACEHOLDER:b.NORMAL}const De=[{page:!0,$component:{src:"src/routes/index.tsx?pick=default&pick=$css",build:()=>import("./c_1y9cimg.mjs"),import:()=>import("./c_1y9cimg.mjs")},$$route:{require:()=>({route:Ze}),src:"src/routes/index.tsx?pick=route"},path:"/",filePath:"/Users/or/Desktop/mediakit2/examples/auth/src/routes/index.tsx"},{page:!0,$component:{src:"src/routes/loader.tsx?pick=default&pick=$css",build:()=>import("./c_1sc1rtv.mjs"),import:()=>import("./c_1sc1rtv.mjs")},$$route:{require:()=>({route:Qe}),src:"src/routes/loader.tsx?pick=route"},path:"/loader",filePath:"/Users/or/Desktop/mediakit2/examples/auth/src/routes/loader.tsx"},{page:!0,$component:{src:"src/routes/protected.tsx?pick=default&pick=$css",build:()=>import("./c_1ph8hba.mjs"),import:()=>import("./c_1ph8hba.mjs")},$$route:{require:()=>({route:et}),src:"src/routes/protected.tsx?pick=route"},path:"/protected",filePath:"/Users/or/Desktop/mediakit2/examples/auth/src/routes/protected.tsx"},{page:!0,$component:{src:"src/routes/test.tsx?pick=default&pick=$css",build:()=>import("./c_1dwqc5y.mjs"),import:()=>import("./c_1dwqc5y.mjs")},path:"/test",filePath:"/Users/or/Desktop/mediakit2/examples/auth/src/routes/test.tsx"},{page:!0,$component:{src:"src/routes/test2.tsx?pick=default&pick=$css",build:()=>import("./c_12zdwre.mjs"),import:()=>import("./c_12zdwre.mjs")},path:"/test2",filePath:"/Users/or/Desktop/mediakit2/examples/auth/src/routes/test2.tsx"},{page:!1,$GET:{src:"src/routes/api/auth/[...solidauth].ts?pick=GET",build:()=>import("./_...solidauth_.mjs"),import:()=>import("./_...solidauth_.mjs")},$POST:{src:"src/routes/api/auth/[...solidauth].ts?pick=POST",build:()=>import("./_...solidauth_2.mjs"),import:()=>import("./_...solidauth_2.mjs")},path:"/api/auth/*solidauth",filePath:"/Users/or/Desktop/mediakit2/examples/auth/src/routes/api/auth/[...solidauth].ts"}],Dr=Nr(De.filter(t=>t.page));function Nr(t){function e(r,s,i,a){const n=Object.values(r).find(o=>i.startsWith(o.id+"/"));return n?(e(n.children||(n.children=[]),s,i.slice(n.id.length)),r):(r.push({...s,id:i,path:i.replace(/\/\([^)/]+\)/g,"").replace(/\([^)/]+\)/g,"")}),r)}return t.sort((r,s)=>r.path.length-s.path.length).reduce((r,s)=>e(r,s,s.path,s.path),[])}function Mr(t){return t.$GET||t.$POST||t.$PUT||t.$PATCH||t.$DELETE}Cr({routes:De.reduce((t,e)=>{if(!Mr(e))return t;let r=e.path.replace(/\/\([^)/]+\)/g,"").replace(/\([^)/]+\)/g,"").replace(/\*([^/]*)/g,(s,i)=>`**:${i}`).split("/").map(s=>s.startsWith(":")||s.startsWith("*")?s:encodeURIComponent(s)).join("/");if(/:[^/]*\?/g.test(r))throw new Error(`Optional parameters are not supported in API routes: ${r}`);if(t[r])throw new Error(`Duplicate API routes for "${r}" found at "${t[r].route.path}" and "${e.path}"`);return t[r]={route:e},t},{})});function Ur(t){t.forEach(e=>{if(!e.attrs.href)return;let r=document.head.querySelector(`link[href="${e.attrs.href}"]`);r||(r=document.createElement("link"),r.setAttribute("rel","preload"),r.setAttribute("as","style"),r.setAttribute("href",e.attrs.href),document.head.appendChild(r))})}var Lr=" ";const _r={style:t=>P("style",t.attrs,()=>ie(t.children),!0),link:t=>P("link",t.attrs,void 0,!0),script:t=>t.attrs.src?P("script",_e(()=>t.attrs,{get id(){return t.key}}),()=>Be(Lr),!0):null,noscript:t=>P("noscript",t.attrs,()=>ie(t.children),!0)};function Br(t,e){let{tag:r,attrs:{key:s,...i}={key:void 0},children:a}=t;return _r[r]({attrs:{...i,nonce:e},key:s,children:a})}function Wr(t,e,r,s="default"){return Ue(async()=>{{const a=(await t.import())[s],o=(await e.inputs?.[t.src].assets()).filter(c=>c.tag==="style"||c.attrs.rel==="stylesheet");return typeof window<"u"&&Ur(o),{default:c=>[...o.map(d=>Br(d)),Le(a,c)]}}})}function Ne(){function t(r){return{...r,...r.$$route?r.$$route.require().route:void 0,info:{...r.$$route?r.$$route.require().route.info:{},filesystem:!0},component:r.$component&&Wr(r.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:r.children?r.children.map(t):void 0}}return Dr.map(t)}let ge;const gs=We?()=>qe().routes:()=>ge||(ge=Ne());function qr(t){const e=Ke(t.nativeEvent,"flash");if(!e)return;let r=JSON.parse(e);if(!r||!r.result)return;const s=[...r.input.slice(0,-1),new Map(r.input[r.input.length-1])];Xe(t.nativeEvent,"flash","",{maxAge:0});const i=r.error?new Error(r.result):r.result;return{input:s,url:r.url,pending:!1,result:r.thrown?void 0:i,error:r.thrown?i:void 0}}async function Hr(t){const e=globalThis.MANIFEST.client;return globalThis.MANIFEST.ssr,t.response.headers.set("Content-Type","text/html"),Object.assign(t,{manifest:await e.json(),assets:[...await e.inputs[e.handler].assets()],router:{submission:qr(t)},routes:Ne(),complete:!1,$islands:new Set})}const Kr=new Set([301,302,303,307,308]);function Xr(t){return t.status&&Kr.has(t.status)?t.status:302}function Gr(t){const e=new TextEncoder().encode(t),r=e.length,s=r.toString(16),i="00000000".substring(0,8-s.length)+s,a=new TextEncoder().encode(`;0x${i};`),n=new Uint8Array(12+r);return n.set(a),n.set(e,12),n}function ye(t,e){return new ReadableStream({start(r){vr(e,{scopeId:t,plugins:[W,q,H,K,x,E,X,G,Y,J],onSerialize(s,i){r.enqueue(Gr(i?`(${it(t)},${s})`:s))},onDone(){r.close()},onError(s){r.error(s)}})}})}async function Yr(t){const e=Ge(t),r=e.request,s=r.headers.get("X-Server-Id"),i=r.headers.get("X-Server-Instance"),a=r.headers.has("X-Single-Flight"),n=new URL(r.url);let o,l;if(s)Or(typeof s=="string","Invalid server function"),[o,l]=s.split("#");else if(o=n.searchParams.get("id"),l=n.searchParams.get("name"),!o||!l)throw new Error("Invalid request");const c=(await globalThis.MANIFEST["server-fns"].chunks[o].import())[l];let d=[];if(!i||t.method==="GET"){const u=n.searchParams.get("args");if(u){const h=JSON.parse(u);(h.t?he(h,{plugins:[W,q,H,K,x,E,X,G,Y,J]}):h).forEach(g=>d.push(g))}}if(t.method==="POST"){const u=r.headers.get("content-type"),h=t.node.req,g=h instanceof ReadableStream,re=g&&h.locked,se=g?h:h.body;if(u?.startsWith("multipart/form-data")||u?.startsWith("application/x-www-form-urlencoded"))d.push(await(re?r:new Request(r,{...r,body:se})).formData());else if(u?.startsWith("application/json")){const Me=re?r:new Request(r,{...r,body:se});d=he(await Me.json(),{plugins:[W,q,H,K,x,E,X,G,Y,J]})}}try{let u=await Se(e,async()=>(we.context={event:e},e.locals.serverFunctionMeta={id:o+"#"+l},c(...d)));if(a&&i&&(u=await ze(e,u)),u instanceof Response){if(u.headers&&u.headers.has("X-Content-Raw"))return u;i&&(u.headers&&ae(t,u.headers),u.status&&(u.status<300||u.status>=400)&&ne(t,u.status),u.customBody?u=await u.customBody():u.body==null&&(u=null))}return i?(k(t,"content-type","text/javascript"),ye(i,u)):be(u,r,d)}catch(u){if(u instanceof Response)a&&i&&(u=await ze(e,u)),u.headers&&ae(t,u.headers),u.status&&(!i||u.status<300||u.status>=400)&&ne(t,u.status),u.customBody?u=u.customBody():u.body==null&&(u=null),k(t,"X-Error","true");else if(i){const h=u instanceof Error?u.message:typeof u=="string"?u:"true";k(t,"X-Error",h.replace(/[\r\n]+/g,""))}else u=be(u,r,d,!0);return i?(k(t,"content-type","text/javascript"),ye(i,u)):u}}function be(t,e,r,s){const i=new URL(e.url),a=t instanceof Error;let n=new URL(e.headers.get("referer")).toString(),o=302;return t instanceof Response&&t.headers.has("Location")&&(n=new URL(t.headers.get("Location"),i.origin+"").toString(),o=Xr(t)),new Response(null,{status:o,headers:{Location:n,...t?{"Set-Cookie":`flash=${JSON.stringify({url:i.pathname+encodeURIComponent(i.search),result:a?t.message:t,thrown:s,error:a,input:[...r.slice(0,-1),[...r[r.length-1].entries()]]})}; Secure; HttpOnly;`}:{}}})}let N;async function ze(t,e){let r,s=new URL(t.request.headers.get("referer")).toString();e instanceof Response&&(e.headers.has("X-Revalidate")&&(r=e.headers.get("X-Revalidate").split(",")),e.headers.has("Location")&&(s=new URL(e.headers.get("Location"),new URL(t.request.url).origin+"").toString()));const i=Ye(t);return i.request=new Request(s),await Se(i,async()=>{await Hr(i),N||(N=(await import("./app.mjs")).default),i.router.dataOnly=r||!0,i.router.previousUrl=t.request.headers.get("referer");try{He(()=>{we.context.event=i,N()})}catch(o){console.log(o)}const a=i.router.data;if(!a)return e;let n=!1;for(const o in a)a[o]===void 0?delete a[o]:n=!0;return n&&(e instanceof Response?e.customBody&&(a._$value=e.customBody()):(a._$value=e,e=new Response(null,{status:200})),e.customBody=()=>a,e.headers.set("X-Single-Flight","true")),e})}const ys=Je(Yr);export{gs as F,ys as h};
